<!-- tested.html (‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GitHub ‡πÇ‡∏î‡∏¢‡∏¢‡∏±‡∏á‡∏Ñ‡∏á‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡πÄ‡∏î‡∏¥‡∏°‡πÑ‡∏ß‡πâ 100%) -->
<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Prompt', sans-serif; margin: 0; padding: 0; background: linear-gradient(to bottom right, #eff6ff, #dbeafe); display: flex; justify-content: center; align-items: center; min-height: 100vh; }
    .container { max-width: 850px; width: 100%; background-color: #ffffff; padding: 2.5rem 3rem; border-radius: 16px; box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); margin: 2rem; }
    .centered-header { text-align: center; }
    .centered-header img { display: block; margin: 0 auto 1rem; width: 100px; height: auto; opacity: 0; animation: logoFade 0.8s forwards ease; }
    @keyframes logoFade { to { opacity: 1; } }
    .swal2-border { border-radius: 1rem; padding: 1.2rem; font-family: 'Prompt', sans-serif; }
    .swal2-title-custom { font-size: 1.2rem; font-weight: bold; color: #1e3a8a; }
    input[type="text"], input[type="email"], input[type="tel"] { width: 100%; padding: 0.6rem; margin-top: 0.25rem; border: 1px solid #ccc; border-radius: 6px; font-size: 1rem; }
    .question-container { background: #ffffff; border: 1px solid #e5e7eb; border-radius: 1rem; padding: 1.5rem; margin-bottom: 1.5rem; box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05); }
    .choice-label { display: flex; align-items: center; padding: 0.75rem 1rem; border: 1px solid #d1d5db; border-radius: 0.75rem; transition: background 0.3s, border 0.3s; cursor: pointer; }
    .choice-label:hover { background: #f3f4f6; border-color: #2563eb; }
    .choice-label input[type="radio"] { margin-right: 0.75rem; accent-color: #2563eb; }
    .btn-info { display: block; margin: 0 auto; padding: 0.85rem 1.5rem; border: none; border-radius: 0.75rem; font-size: 1rem; font-weight: 500; color: #fff; background-color: #475569; cursor: pointer; transition: background 0.3s; }
    .btn-info:hover { background-color: #334155; }
    .test-complete-message { font-size: 1.2rem; font-weight: 500; color: #dc2626; text-align: center; margin-top: 2rem; margin-bottom: 1.2rem; }
  </style>
</head>

<body>
  <div class="container">
    <header class="centered-header">
      <img src="https://github.com/ittcl999/svr-frontend/blob/main/bg-logo-transport.png?raw=true" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó">
      <h3>‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à</h3>
      <div class="link-section">
        üìò <a href="https://drive.google.com/file/d/1Z5cbRfR9T9CL9t024MkmxzyLrROAvn9y/view" target="_blank">‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</a>
      </div>
    </header>

    <div id="infoForm">
      <label for="idCard" class="required-label">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
      <input type="tel" id="idCard" placeholder="0-0000-00000-00-0" maxlength="17">
      <label for="name" class="required-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" id="name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
      <label for="company" class="required-label">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</label>
      <input type="text" id="company" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
      <label for="phone" class="required-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
      <input type="tel" id="phone" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">
      <label for="email">Email:</label>
      <input type="email" id="email" placeholder="example@email.com">
      <div style="text-align: center;">
        <button onclick="startQuiz(event)">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
      </div>
    </div>

    <form id="quizForm" style="display:none">
      <div id="questions"></div>
      <div style="text-align: center;">
        <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
      </div>
    </form>

    <div id="result"></div>
  </div>

  <script>
    const GAS_URL = 'https://script.google.com/macros/s/AKfycbym5zxW382G2enqHVpsEkltXSCeaWEXdWmUqpz11Wxfi2pxp8Pg2SP9RmCbfDLtPU6T/exec'; // üîÅ ‡πÉ‡∏™‡πà Web App URL ‡∏ó‡∏µ‡πà deploy ‡πÅ‡∏•‡πâ‡∏ß
    let questions = [];

    function fetchPost(payload) {
      return fetch(GAS_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload)
      }).then(res => res.json());
    }

    function fetchGet(params) {
      const url = GAS_URL + '?' + new URLSearchParams(params);
      return fetch(url).then(res => res.json());
    }

    function startQuiz() {
      const idCardRaw = document.getElementById("idCard").value.trim();
      const idCard = idCardRaw.replace(/\D/g, "");
      const name = document.getElementById("name").value.trim();
      const company = document.getElementById("company").value.trim();
      const phone = document.getElementById("phone").value.trim();

      if (!idCard || idCard.length !== 13 || !name || !company || !phone) {
        Swal.fire({
          icon: 'warning',
          title: '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
          text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
          customClass: { popup: 'swal2-border', title: 'swal2-title-custom' }
        });
        return;
      }

      Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö...', allowOutsideClick: false, didOpen: () => Swal.showLoading(), customClass: { popup: 'swal2-border' } });
      fetchGet({ action: 'checkTestStatus', idCard }).then(status => {
        Swal.close();
        if (status.tested) {
          Swal.fire({ icon: 'info', title: '‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß', html: `‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß<br>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≠‡∏ö‡πÑ‡∏î‡πâ‡∏≠‡∏µ‡∏Å‡∏ó‡∏µ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà <b>${status.statusMessage}</b>`, customClass: { popup: 'swal2-border', title: 'swal2-title-custom' } });
        } else {
          Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏™‡∏≠‡∏ö...', didOpen: () => Swal.showLoading(), allowOutsideClick: false });
          fetchGet({ action: 'getQuestions' }).then(qs => {
            Swal.close();
            questions = qs;
            document.getElementById("quizForm").style.display = 'block';
            document.getElementById("infoForm").style.display = 'none';
            renderQuestions();
          });
        }
      });
    }

    function renderQuestions() {
      const container = document.getElementById("questions");
      container.innerHTML = "";
      questions.forEach((q, i) => {
        const div = document.createElement("div");
        div.className = "question-container";
        div.innerHTML = `<div class='question-header'><h2 class='question-number'>‡∏Ç‡πâ‡∏≠ ${i + 1}</h2><p class='question-text'>${q.question}</p></div><div class='choices'>${q.choices.map((c, j) => `<label class='choice-label'><input type='radio' name='q${i}' value='${j}'><span class='choice-text'>${c}</span></label>`).join('')}</div>`;
        container.appendChild(div);
      });
    }

    document.getElementById("quizForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const answers = questions.map((q, i) => {
        const selected = document.querySelector(`input[name='q${i}']:checked`);
        return selected ? parseInt(selected.value) : -1;
      });
      if (answers.includes(-1)) {
        Swal.fire({ icon: 'warning', title: '‡∏¢‡∏±‡∏á‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö', text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠', customClass: { popup: 'swal2-border' } });
        return;
      }

      const payload = {
        action: 'submitAnswers',
        name: document.getElementById("name").value,
        idCard: document.getElementById("idCard").value,
        company: document.getElementById("company").value,
        phone: document.getElementById("phone").value,
        email: document.getElementById("email").value,
        answers
      };

      Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•...', didOpen: () => Swal.showLoading(), customClass: { popup: 'swal2-border' } });
      fetchPost(payload).then(() => {
        Swal.close();
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = `<h4 class='test-complete-message'>‡∏Ñ‡∏∏‡∏ì ${payload.name} ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</h4><button onclick="goTo('viewForm')" class="btn-info">üìÑ ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</button>`;
        document.getElementById("quizForm").style.display = 'none';
      });
    });

    function formatThaiID(id) {
      const v = id.replace(/\D/g, "").slice(0, 13);
      const parts = [v.slice(0, 1), v.slice(1, 5), v.slice(5, 10), v.slice(10, 12), v.slice(12, 13)];
      return parts.filter(Boolean).join("-");
    }

    document.getElementById("idCard").addEventListener("input", function () {
      this.value = formatThaiID(this.value);
    });

    function goTo(action) {
      window.location.href = `${action}.html`;
    }
  </script>
</body>

</html>
