<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <base target="_top">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600&display=swap" rel="stylesheet">

  <style>
    /* body {
      font-family: 'Prompt', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #dbeafe, #f0f9ff);
      background: linear-gradient(to bottom right, #eff6ff, #dbeafe);
    } */

    body {
      font-family: 'Prompt', sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to bottom right, #eff6ff, #dbeafe);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }


    /* .container {
      max-width: 850px;
      margin: 3rem 1.5rem;
      background-color: #ffffff;
      padding: 2.5rem 3rem;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    } */

    .container {
      max-width: 850px;
      width: 100%;
      background-color: #ffffff;
      padding: 2.5rem 3rem;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
      margin: 2rem;
    }


    .logo {
      display: block;
      margin: 0 auto 1rem auto;
      width: 100px;
      height: auto;
    }

    h1 {
      text-align: center;
      color: #1d4ed8;
    }

    h2 {
      color: #1e3a8a;
      text-align: left;
      font-weight: 600;
    }

    .centered-header h3 {
      font-size: 1.4rem;
      font-weight: 600;
      color: #1d4ed8;
      margin: 0.3rem 0 0.6rem;
    }

    .centered-header p {
      font-size: 1rem;
      color: #444;
      margin-bottom: 1.5rem;
    }


    label {
      font-weight: 500;
      margin-top: 1rem;
      display: block;
      color: #333;
    }

    input[type="text"],
    input[type="email"],
    input[type="tel"] {
      width: 100%;
      padding: 0.6rem;
      margin-top: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }

    .question {
      margin-bottom: 2rem;
    }

    .question p {
      font-weight: bold;
      margin-bottom: 0.5rem;
    }

    .choice-label {
      display: block;
      margin-left: 1rem;
      margin-bottom: 0.4rem;
      font-weight: normal;
      color: #444;
    }

    button {
      background-color: #2563eb;
      color: white;
      border: none;
      padding: 0.8rem 1.5rem;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 500;
      cursor: pointer;
      margin-top: 2rem;
    }

    button:hover {
      background-color: #1d4ed8;
    }

    #result {
      text-align: center;
      font-size: 1.2rem;
      margin-top: 2rem;
    }

    .centered-header .link-section {
      margin-top: 0.5rem;
    }


    .centered-header .link-section a {
      color: #444;
      font-weight: bold;
      font-size: 1rem;
      text-decoration: none;
    }


    .centered-header .link-section a:hover {
      text-decoration: underline;
    }

    .swal2-border {
      border-radius: 12px !important;
      font-family: 'Prompt', sans-serif;
    }

    .swal2-title-custom {
      font-size: 1.2rem;
      font-weight: bold;
      color: #1e3a8a;
      /* Tailwind blue-800 */
    }

    .swal2-border {
      border-radius: 1rem;
      /* ‡∏°‡∏∏‡∏°‡πÇ‡∏Ñ‡πâ‡∏á‡∏°‡∏ô‡∏™‡∏ß‡∏¢ */
      padding: 1.2rem;
    }


    .question-container {
      background: #ffffff;
      border: 1px solid #e5e7eb;
      border-radius: 1rem;
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
    }

    .question-header {
      margin-bottom: 1rem;
    }

    .question-number {
      color: #1d4ed8;
      /* Tailwind Blue-700 */
      font-size: 1.25rem;
      font-weight: 700;
      margin: 0 0 0.25rem 0;
    }

    .question-text {
      font-size: 1.1rem;
      margin: 0;
    }

    .choices {
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .choice-label {
      display: flex;
      align-items: center;
      padding: 0.75rem 1rem;
      border: 1px solid #d1d5db;
      border-radius: 0.75rem;
      transition: background 0.3s, border 0.3s;
      cursor: pointer;
    }

    .choice-label:hover {
      background: #f3f4f6;
      border-color: #2563eb;
    }

    .choice-label input[type="radio"] {
      margin-right: 0.75rem;
      accent-color: #2563eb;
    }

    .choice-text {
      font-size: 1rem;
    }


    .required-label::after {
      content: "*";
      margin-left: .25rem;
      color: #dc3545;
      /* ‡πÅ‡∏î‡∏á‡πÄ‡∏Ç‡πâ‡∏°‡πÅ‡∏ô‡∏ß Bootstrap */
    }

    header img {
      width: 100px;
      height: auto;
      margin-bottom: 1rem;
      opacity: 0;
      animation: logoFade 0.8s forwards ease;
    }

    @keyframes logoFade {
      to {
        opacity: 1;
      }
    }

    .centered-header {
      text-align: center;
    }

    .centered-header img {
      display: block;
      margin: 0 auto 1rem;
      width: 100px;
      height: auto;
      opacity: 0;
      animation: logoFade 0.8s forwards ease;
    }

    .btn {
      display: block;
      width: 100%;
      padding: 0.85rem 1.2rem;
      margin: 0.6rem 0;
      border: none;
      border-radius: 0.75rem;
      font-size: 1rem;
      font-weight: 500;
      text-align: center;
      color: #fff;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06);
      font-family: 'Prompt', sans-serif;
    }

    /* ‡∏™‡∏µ‡∏ü‡πâ‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏´‡∏£‡∏π */
    .btn-primary {
      background-color: #2563eb;
    }

    .btn-primary:hover {
      background-color: #1e40af;
    }

    /* ‡∏™‡∏µ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß‡∏™‡∏∏‡∏†‡∏≤‡∏û */
    .btn-success {
      background-color: #059669;
    }

    .btn-success:hover {
      background-color: #047857;
    }

    /* ‡∏™‡∏µ‡∏Å‡∏£‡∏°‡∏ô‡∏∏‡πà‡∏° */
    /* .btn-info {
      background-color: #475569;
    } */

    .btn-info {
      display: block;
      margin: 0 auto;
      padding: 0.85rem 1.5rem;
      border: none;
      border-radius: 0.75rem;
      font-size: 1rem;
      font-weight: 500;
      color: #fff;
      background-color: #475569;
      cursor: pointer;
      transition: background 0.3s;
    }

    /* .btn-info:hover {
      background-color: #334155;
    } */

    .btn-info:hover {
      background-color: #334155;
    }


    .btn:hover {
      background-color: #1e40af;
    }

    /* .test-complete-message {
      font-size: 1.2rem;
      font-weight: 400;
      color: #ff0000;
      margin-top: 2rem;
      margin-bottom: 1.2rem;
    } */

    .test-complete-message {
      font-size: 1.2rem;
      font-weight: 500;
      color: #dc2626;
      text-align: center;
      margin-top: 2rem;
      margin-bottom: 1.2rem;
    }
  </style>
</head>

<body>
  <div class="container">
    <header class="centered-header">
      <img src="https://datagov.mot.go.th/uploads/group/2021-06-17-091516.344386imgd1daf68b032d6c67143d45f8686e2aea.png"
       alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó" width="100" height="100" loading="lazy" decoding="async">
      <h3>‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏°‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏Ç‡πâ‡∏≤‡πÉ‡∏à</h3>
      <!-- <p>‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏´‡∏°‡∏≤‡πÅ‡∏•‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏Ñ‡∏•‡∏†‡∏≤‡∏¢‡∏ô‡∏≠‡∏Å ‡∏Å‡πà‡∏≠‡∏ô‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</p> -->

      <div class="link-section">
        üìò <a href="https://drive.google.com/file/d/1Z5cbRfR9T9CL9t024MkmxzyLrROAvn9y/view" target="_blank">
          ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏°‡∏±‡πà‡∏ô‡∏Ñ‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà
        </a>
      </div>
    </header>

    <div id="infoForm">
      <label for="idCard" class="required-label">‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô</label>
      <input type="tel" id="idCard" placeholder="0-0000-00000-00-0" maxlength="17">


      <label for="name"  class="required-label">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</label>
      <input type="text" id="name" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡πá‡∏°‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">

      <label for="company"  class="required-label">‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó</label>
      <input type="text" id="company" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">

      <label for="phone"  class="required-label">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
      <input type="tel" id="phone" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå">

      <label for="email">Email:</label>
      <input type="email" id="email" placeholder="example@email.com">

      <div style="text-align: center;">
        <button onclick="startQuiz(event)">‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö</button>
      </div>
    </div>


    <form id="quizForm" style="display:none">
      <div id="questions"></div>
      <div style="text-align: center;">
        <button type="submit">‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö</button>
      </div>
    </form>

    <div id="result"></div>
  </div>

  <script>
    let questions = [];

    function startQuiz() {
  const idCardRaw = document.getElementById("idCard").value.trim();
  const idCard = idCardRaw.replace(/\D/g, "");
  const name = document.getElementById("name").value.trim();
  const company = document.getElementById("company").value.trim();
  const phone = document.getElementById("phone").value.trim();
  const email = document.getElementById("email").value.trim();
  const startButton = event.target;
  startButton.disabled = true;
  startButton.style.display = "none";


  if (!idCard) {
    Swal.fire({
      icon: 'warning',
      title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å "‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô"',
      html: '<span style="color:red">‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô 13 ‡∏´‡∏•‡∏±‡∏Å</span><br>‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });
    startButton.disabled = false;
    startButton.style.display = "inline-block";
    return;
  }

  if (idCard.length !== 13) {
    Swal.fire({
      icon: 'warning',
      title: '‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö',
      html: '<span style="color:red">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏•‡∏Ç‡∏Ñ‡∏£‡∏ö 13 ‡∏´‡∏•‡∏±‡∏Å</span><br>‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });
    startButton.disabled = false;
    startButton.style.display = "inline-block";
    return;
  }

  if (!name) {
    Swal.fire({
      icon: 'warning',
      title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å "‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•"',
      html: '<span style="color:red">‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</span><br>‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });
    startButton.disabled = false;
    startButton.style.display = "inline-block";
    return;
  }

  if (!company) {
    Swal.fire({
      icon: 'warning',
      title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å "‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó"',
      html: '<span style="color:red">‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠ ‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó/‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏á‡∏≤‡∏ô<br>‡∏ï‡πâ‡∏ô‡∏™‡∏±‡∏á‡∏Å‡∏±‡∏î‡∏Ç‡∏≠‡∏á‡∏ó‡πà‡∏≤‡∏ô</span><br>‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });
    startButton.disabled = false;
    startButton.style.display = "inline-block";
    return;
  }

  if (!phone) {
    Swal.fire({
      icon: 'warning',
      title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å "‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå"',
      html: '<span style="color:red">‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡πÑ‡∏î‡πâ</span><br>‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });
    startButton.disabled = false;
    startButton.style.display = "inline-block";
    return;
  }

  // if (!email) {
  //   Swal.fire({
  //     icon: 'warning',
  //     title: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Email',
  //     text: '‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô',
  //     width: 'clamp(300px, 90%, 420px)', // Responsive width
  //     confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
  //     confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
  //     customClass: {
  //       title: 'swal2-title-custom',
  //       popup: 'swal2-border'
  //     }
  //   });
  //   startButton.disabled = false;
  //   startButton.style.display = "inline-block";
  //   return;
  // }

  // ‡πÅ‡∏™‡∏î‡∏á SweetAlert "‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•..."
    Swal.fire({
      title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
      allowOutsideClick: false,
      didOpen: () => Swal.showLoading(),
      width: 'clamp(300px, 90%, 420px)',
      customClass: { popup: 'swal2-border', title: 'swal2-title-custom' }
    });

  // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏≠‡∏ö‡∏à‡∏≤‡∏Å Script
  google.script.run.withSuccessHandler(function (status) {
    Swal.close(); // ‡∏õ‡∏¥‡∏î loading ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
    if (status.tested) {
    Swal.fire({
        icon: 'info',
        title: '‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß', 
        html: `<span style="font-size: 1em; color: #ff0000;">‡∏û‡∏ö‡∏ß‡πà‡∏≤‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏ö‡∏±‡∏ï‡∏£‡∏õ‡∏£‡∏∞‡∏ä‡∏≤‡∏ä‡∏ô‡∏î‡∏±‡∏á‡∏Å‡∏•‡πà‡∏≤‡∏ß</span><br>
               ‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß<br>
               ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≠‡∏ö‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ñ‡∏±‡∏î‡πÑ‡∏õ‡πÑ‡∏î‡πâ‡πÉ‡∏ô<br>
               <span style="font-size: 1em; color: #0062ff;">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà ${status.statusMessage}</span>
                `, 
        confirmButtonText: '‡∏£‡∏±‡∏ö‡∏ó‡∏£‡∏≤‡∏ö' ,
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });

      startButton.disabled = false;
      startButton.style.display = "inline-block";

    } else {
      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö',
        html: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...',
        allowOutsideClick: false,
        allowEscapeKey: false,
        didOpen: () => {
          Swal.showLoading();
        },
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });

      google.script.run.withSuccessHandler(function (qs) {
        Swal.close(); //
        questions = qs;
        document.getElementById("quizForm").style.display = "block";
        document.getElementById("infoForm").style.display = "none";
        renderQuestions();
      }).getQuestions();
    }
  }).checkTestStatus(idCard);
}





    // function renderQuestions() {
    //   const container = document.getElementById("questions");
    //   container.innerHTML = "";
    //   questions.forEach((q, i) => {
    //     const div = document.createElement("div");
    //     div.className = "question";
    //     div.innerHTML = `<h2>‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${i + 1}</h2><p>${q.question}</p>` +
    //       q.choices.map((c, j) =>
    //         `<label class="choice-label"><input type="radio" name="q${i}" value="${j}" required> ${c}</label>`
    //       ).join("");
    //     container.appendChild(div);
    //   });
    // }

    function renderQuestions() {
      const container = document.getElementById("questions");
      container.innerHTML = "";

      questions.forEach((q, i) => {
        const div = document.createElement("div");
        div.className = "question-container";

        div.innerHTML = `
          <div class="question-header">
            <h2 class="question-number">‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${i + 1}</h2>
            <p class="question-text">${q.question}</p>
          </div>
          <div class="choices">
            ${q.choices.map((c, j) => `
              <label class="choice-label">
                <input type="radio" name="q${i}" value="${j}" >
                <span class="choice-text">${c}</span>
              </label>
            `).join("")}
          </div>
        `;

        container.appendChild(div);
      });
    }



    document.getElementById("quizForm").addEventListener("submit", function(e) {
      e.preventDefault();

      const submitBtn = e.target.querySelector("button[type='submit']");
      submitBtn.disabled = true;
      submitBtn.style.display = "none";

      const answers = questions.map((q, i) => {
        const selected = document.querySelector(`input[name='q${i}']:checked`);
        return selected ? parseInt(selected.value) : -1;
      });

      const unanswered = answers.indexOf(-1);
      if (unanswered !== -1) {
    Swal.fire({
      icon: 'warning',
      title: '‡∏¢‡∏±‡∏á‡∏ï‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ç‡πâ‡∏≠',
      text: `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏≠‡∏ö‡∏Ñ‡∏≥‡∏ñ‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö (‡πÄ‡∏ä‡πà‡∏ô ‡∏Ç‡πâ‡∏≠‡∏ó‡∏µ‡πà ${unanswered + 1})`,
      width: 'clamp(300px, 90%, 420px)',
      confirmButtonColor: '#2563eb',
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });

    // ‡πÅ‡∏™‡∏î‡∏á‡∏õ‡∏∏‡πà‡∏°‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤
    submitBtn.disabled = false;
    submitBtn.style.display = "inline-block";
    return;
  }

      const name = document.getElementById("name").value;
      const idCard = document.getElementById("idCard").value;
      const company = document.getElementById("company").value;
      const phone = document.getElementById("phone").value;
      const email = document.getElementById("email").value;

      Swal.fire({
        title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ñ‡∏≥‡∏ï‡∏≠‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì',
        text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...',
        allowOutsideClick: false,
        allowEscapeKey: false,
        didOpen: () => {
          Swal.showLoading();
        },
      width: 'clamp(300px, 90%, 420px)', // Responsive width
      confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
      confirmButtonColor: '#2563eb', // ‡∏™‡∏µ‡∏õ‡∏∏‡πà‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ö‡∏ö Tailwind blue-600
      customClass: {
        title: 'swal2-title-custom',
        popup: 'swal2-border'
      }
    });

      google.script.run.withSuccessHandler(function(result) {
        Swal.close();
        const resultDiv = document.getElementById("result");
        resultDiv.innerHTML = `
        <h4 class="test-complete-message">‡∏Ñ‡∏∏‡∏ì ${name} ‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß</h4>
        <button onclick="goTo('viewForm')" class="btn btn-info">üìÑ ‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà</button>

          `;
        document.getElementById("quizForm").style.display = "none";
      }).submitAnswers({ name, idCard, company, phone, email, answers });
    });
    // google.script.run.withSuccessHandler(function(result) {
    //     Swal.close();
    //     const resultDiv = document.getElementById("result");
    //     resultDiv.innerHTML = `<h2>‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö</h2>
    //       <p>‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏î‡πâ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô ${result.score} ‡∏à‡∏≤‡∏Å ${questions.length} ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</p>
    //       <p style="color: ${result.passed ? 'green' : 'red'}">
    //         ${result.passed ? '‡∏ú‡πà‡∏≤‡∏ô ‚úÖ<br>‡∏Ñ‡∏∏‡∏ì‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏£‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°‡∏Ç‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ‡πÅ‡∏•‡πâ‡∏ß' : '‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô ‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ó‡∏ö‡∏ó‡∏ß‡∏ô‡∏Ñ‡∏π‡πà‡∏°‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡∏ó‡∏≥‡πÅ‡∏ö‡∏ö‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÉ‡∏´‡∏°‡πà'}
    //       </p>`;
    //     document.getElementById("quizForm").style.display = "none";
    //   }).submitAnswers({ name, idCard, company, phone, email, answers });
    // });
  </script>

  <script>
    function formatThaiID(id) {
  const v = id.replace(/\D/g, "").slice(0, 13); // ‡∏•‡∏ö non-digit, ‡∏à‡∏≥‡∏Å‡∏±‡∏î 13 ‡∏´‡∏•‡∏±‡∏Å
  const parts = [v.slice(0, 1), v.slice(1, 5), v.slice(5, 10), v.slice(10, 12), v.slice(12, 13)];
  return parts.filter(Boolean).join("-");
}

document.getElementById("idCard").addEventListener("input", function () {
  const formatted = formatThaiID(this.value);
  this.value = formatted;
});

  </script>

  <script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbym5zxW382G2enqHVpsEkltXSCeaWEXdWmUqpz11Wxfi2pxp8Pg2SP9RmCbfDLtPU6T/exec";
    function goTo(action) {
      window.location.href = `${SCRIPT_URL}?action=${action}`;
    }
  </script>

</body>

</html>
